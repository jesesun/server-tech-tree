# 编程语言表达力

编程语言是最直接提升开发效率的因素。选择适合的语言可以事半功倍。语言是计算机科学里一门综合的技术，要解决开发效率、性能、安全等一系列元问题，其中开发效率是大多数语言追求的最关键指标，一门学习曲线陡峭的语言注定只能是小众的。当然没有银弹，只是针对某些领域的开发效率提升，那就有可能会牺牲某些领域的开发效率，比如Rust在安全上的投入，开发阶段的成本会上去，但实际上却显著减少运行阶段由于内存安全引发的修复成本，反而提升了整个软件生命周期的开发效率。

<nav>
<a href="#编程语言历史与现状">一、编程语言历史与现状</a><br/>
<a href="#现代编程语言高级特性">二、现代编程语言高级特性</a><br/>
</nav>
<br/>

## 编程语言历史与现状

最早追溯到1842年
真正意义上的现代编程语言则是从  开始
https://zh.wikipedia.org/wiki/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80%E6%AD%B7%E5%8F%B2

分类：图

从机器0/1到汇编再到高级语言，发展趋势是越来越远离晦涩的硬件，那些对人类更友好简单、能更快开发出功能的高级语言成为主流。
机器码-》汇编（人容易理解，不具备跨机器移植性？）-》basic等（高级语言雏形，人更容易理解，逐步具备跨机器移植性？）-》C等（UNIX等现代系统级软件诞生，追求性能）-》java等（互联网、企业等应用，追求安全性和开发效率）-》go等（多核、云原生）

图灵完备

上世纪90年代是高级语言的黄金时代，89年Python、94年PHP、95年Java和JavaScript、00年C#，这些90后语言占据了当今计算机语言绝对统治地位，70后C语言、80后C++、00后代表Golang短时间内根本无法撼动他们。与此同时，由于人类对性能门派的拥护，或者由于习惯难以改变，或者由于升级成本较大，现在很多企业、机构或个人还在使用对程序员不太友好但性能杠杠的C语言，参见下图的TIOBE 2019年11月榜单，C语言占据16.037%份额，排在第二位，仅落后Java。

## 现代编程语言高级特性

为了适用当前环境、更有效利用现代硬件，各种新语言新高级特性层出不穷，不断为开发者提供更高的开发效率。下面，我们来看看几个关键常见的语言高级特性。

* 变量：不同语言对变量命名规则要求不同，有些松有些严，比如Java可以随意命名、Ruby规定类名常量名以大写字母开头、PHP用$修饰变量等。松要求可降低新手学习成本，对他们开发效率有帮助，而严要求则增加可读性，有利于控制系统的升级和维护成本，提高后续的开发效率
* 代码块：代码块的划分规则会轻微影响到开发效率，使用不当容易导致难以发现的bug
  * 用`{}`圈定一个代码块，以C为代表，是大多数现代语言的选择。该规则往往不强制单语句使用，这经常容易留下bug
  * 用缩进来表示，以Python为代表
  * 以`end`表示一段代码块的结束，以Ruby为代表
* 编程模式：也称为编程范式，可以理解为一种种编程风格，不同编程模式适合不同场景，用对了可大幅提升软件开发效率。大多数语言都支持多模式，有些设计之初就引入多模式，比如Rust一开始就支持面向对象和函数式编程，有些则在不断更新中加入新模式，比如Java 8才引入lambda实现函数式编程。语言支持某种模式，并不意味着开发者能设计出符合该模式的正确程序，比如初学者经常抽象出不合理的对象，导致表面上是面向对象的程序实际退化成了面向过程。编程模式分为三大类（参见上面的编程语言分类图）：`指令式/命令式`、`声明式`、`元编程`。指令式要求开发者自己编写完成问题的每一步。声明式要求开发者仅编写问题的目标而让语言系统自行完成问题的各个步骤。元编程是用代码生成代码的编程模式，如果所用语言不支持某些喜欢的语法，但该语言支持元编程，开发者就可以造出这些语法，元编程常见的实现手段包括宏、反射等。我们最常用的模式是指令式（面向过程、面向对象等）和声明式（函数式、SQL等），下面具体介绍一下
  * 面向过程编程`(Procedure Oriented Programming, POP)`：POP思想是将问题拆解成一个个步骤，每个步骤可以是一段代码、n个函数、n个类，**用步骤来组织程序**。以造房子为例，POP就是依次实现打地基、盖楼、装修等步骤。POP是非常直观的编程模式，大多数语言都支持POP，很多时候我们用其他编程模式设计出POP系统。POP在简单场景下开发效率最高，但在复杂场景下难以设计出扩展性良好和简洁的系统，开发维护成本将变大
  * 面向对象编程`(Object Oriented Programming, OOP)`：OOP思想是将问题抽象出所有参与对象，将每个对象所有属性和行为都封装到一个类里，**用对象来组织程序**。仍以造房子为例，我们很容易就能抽象出参与对象是房子，房子类由对象属性（门、窗、材料等变量）和对象行为（打地基、盖楼、装修等方法）组成，初看之下OOP比POP更高级了，但似乎更费心智，岂不是会把开发效率降下来？如果我们把场景弄得复杂一点，假设系统要求适用不同类型的房子，虽然不同房子基本属性和行为是差不多的，但难点在于要低成本适配不同的地方，比如城市一般的商品房需要增加土地购买行为、茅草屋不需要装修、不同房子材料不同等，如果用POP我们只能针对不同房子编写不同程序，而OOP通过继承、多态等设计极容易将程序组织成扩展性非常高的形态，无论增加多少种房子对程序的改造都很小甚至零改造，极大提升开发效率。OOP有三大特征：封装、继承、多态

    * 封装：将一个对象所有属性和行为封装在一起，比如Java的class或者Go的struct。封装实现程序的高内聚低耦合，难点在于是否合理抽象出所有参与对象以及对象属性和行为，这需要开发者有足够的训练量和熟悉业务。接口也是非常重要的封装形式，很多语言采用显式实现接口的风格，比如Java，但也有一些语言采用隐式实现，比如Go中只要实现了某个接口的所有方法就被认为实现了该接口。显式实现接口方式直观易懂，但接口修改后所有实现对象需要随之修改，而隐式实现接口方式没有这个问题，但这种不直观的风格会使阅读和梳理代码时花费更多精力

    * 继承：如果一个对象无法完成所有事情，我们可以实现一个子对象来继承该对象，然后在子对象上进行扩展，这实现了代码的高度复用。继承主要分为单一继承和多重继承。单一继承仅允许继承一个父对象，以Java为代表，这种方式简单不易错但无法复用多个对象代码。多重继承允许继承多个父对象，以C++为代表，可以复用多个对象代码，但多个父对象存在相同方法时会造成二义性，而且实现起来复杂得多，多重继承把所有对象变成有向无环图`(Directed Acyclic Graph, DAG)`，一般用广度优先`(Breadth-First-Search, BFS)`或深度优先`(Depth-First-Search, DFS)`算法搜索，也有某些语言（比如Python等）用`C3`搜索方法。为了弥补单一或多重继承的短板，各语言会做适当的设计，比如Java允许多接口以实现与多重继承相同的效果、Python在多重继承基础上引入[Mix-in机制](https://zhuanlan.zhihu.com/p/138046102)。Go提供了另一种代码复用风格，被复用的对象以匿名成员的方式（无需给成员命名）集成进目标对象，这实际是一种组合，取代了传统的继承实现复用，是践行`组合优于继承`的一种设计

    * 多态：如果一个对象拥有多种形态，利用多态设计将多种形态统一关联起来，不需要为每种形态单独编写对象。多态分为动态多态和静态多态，也称为运行期多态和编译期多态，区别在于是在运行期还是编译期确定使用对象的哪个形态。多态的常见运用是方法重载和重写，以Java为例，重载方法和静态同名方法的调用在编译期可以确定使用哪个类和方法，属于静态多态，而非静态重写方法的调用要到类加载期或运行期才能确定，属于动态多态。还有一种很重要的多态运用，将类型作为多态参数，称为`泛型`，举个例子，定义一个泛型方法`func(<T> a)`，T表示可以赋予不同类型，我们可以这么使用该方法`func(123)`或`func("abc")`。一般泛型属于静态多态，以Java为例，能在编译期使用类型擦除技术将`<T>`替换成具体的类型
  * 函数式编程`(Functional Programming, FP)`
* 内存管理
  * 指针
  * gc
  * 内存安全：Rust
* 并发
  * 多进程
  * 多线程
  * 多协程
* 虚拟机
* 类型系统
* 异常处理
* FFI
* 语法糖
  * 多入参
  * 多出参
